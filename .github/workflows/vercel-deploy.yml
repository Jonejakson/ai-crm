name: Trigger Vercel Deploy

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Check Vercel Deploy Hook URL
        run: |
          if [ -z "${{ secrets.VERCEL_DEPLOY_HOOK_URL }}" ]; then
            echo "‚ùå VERCEL_DEPLOY_HOOK_URL –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ GitHub Secrets!"
            echo "–î–æ–±–∞–≤—å—Ç–µ secret: Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí New repository secret"
            exit 1
          else
            echo "‚úÖ VERCEL_DEPLOY_HOOK_URL –Ω–∞–π–¥–µ–Ω"
          fi
      
      - name: Trigger Vercel Deploy Hook
        run: |
          echo "üöÄ –ó–∞–ø—É—Å–∫–∞—é –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Vercel Deploy Hook..."
          response=$(curl -s -w "\n%{http_code}" -X POST "${{ secrets.VERCEL_DEPLOY_HOOK_URL }}")
          http_code=$(echo "$response" | tail -n1)
          body=$(echo "$response" | head -n-1)
          
          if [ "$http_code" -eq 200 ] || [ "$http_code" -eq 201 ]; then
            echo "‚úÖ –î–µ–ø–ª–æ–π —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω! HTTP $http_code"
            echo "Response: $body"
          else
            echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –¥–µ–ø–ª–æ—è. HTTP $http_code"
            echo "Response: $body"
            exit 1
          fi
        env:
          VERCEL_DEPLOY_HOOK_URL: ${{ secrets.VERCEL_DEPLOY_HOOK_URL }}

