# üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç

## ‚úÖ –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ

### 1. ENCRYPTION_KEY ‚úÖ
- **–°—Ç–∞—Ç—É—Å:** –ù–∞—Å—Ç—Ä–æ–µ–Ω
- **–î–ª–∏–Ω–∞:** 64 —Å–∏–º–≤–æ–ª–∞ (hex)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** Health check endpoint –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `encryption: ok`
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π, —Ç–æ–∫–µ–Ω–æ–≤, API –∫–ª—é—á–µ–π

### 2. Rate Limiting ‚úÖ
- **–°—Ç–∞—Ç—É—Å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `middleware.ts` –∏ `lib/rate-limit.ts`
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
  - –ü—É–±–ª–∏—á–Ω—ã–µ endpoints: 100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
  - API endpoints: 500 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
  - Webhook endpoints: 200 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
  - –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ: 1000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
  - –ê–¥–º–∏–Ω—ã: 5000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É

### 3. Security Headers ‚úÖ
- **–°—Ç–∞—Ç—É—Å:** –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ `middleware.ts`
- **–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
  - `X-Frame-Options: DENY` - –∑–∞—â–∏—Ç–∞ –æ—Ç clickjacking
  - `X-Content-Type-Options: nosniff` - –∑–∞—â–∏—Ç–∞ –æ—Ç MIME sniffing
  - `X-XSS-Protection: 1; mode=block` - –∑–∞—â–∏—Ç–∞ –æ—Ç XSS
  - `Referrer-Policy: strict-origin-when-cross-origin`
  - `Permissions-Policy` - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ API –±—Ä–∞—É–∑–µ—Ä–∞
  - `Content-Security-Policy` - –ø–æ–ª–∏—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
  - `Strict-Transport-Security` - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π HTTPS (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)

### 4. CORS ‚úÖ
- **–°—Ç–∞—Ç—É—Å:** –ù–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ Next.js middleware
- **–ü–æ–ª–∏—Ç–∏–∫–∞:** –†–∞–∑—Ä–µ—à–µ–Ω —Ç–æ–ª—å–∫–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ–º–µ–Ω
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –í `middleware.ts` –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—É–±–ª–∏—á–Ω—ã–µ –ø—É—Ç–∏

### 5. –ó–∞—â–∏—Ç–∞ –æ—Ç SQL Injection ‚úÖ
- **–°—Ç–∞—Ç—É—Å:** –ó–∞—â–∏—â–µ–Ω–æ
- **–ú–µ—Ö–∞–Ω–∏–∑–º:** Prisma ORM –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î –∏–¥—É—Ç —á–µ—Ä–µ–∑ Prisma

### 6. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚úÖ
- **–°—Ç–∞—Ç—É—Å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Zod –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å—Ö–µ–º
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –í—Å–µ API endpoints –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é

### 7. HTTPS ‚úÖ
- **–°—Ç–∞—Ç—É—Å:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** Health check endpoint –¥–æ—Å—Ç—É–ø–µ–Ω
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL —á–µ—Ä–µ–∑ nginx –∏–ª–∏ Let's Encrypt

## üîß –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `scripts/check-security.sh` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
cd /opt/flamecrm
bash scripts/check-security.sh
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
1. –ù–∞–ª–∏—á–∏–µ –∏ –¥–ª–∏–Ω–∞ ENCRYPTION_KEY
2. NODE_ENV —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ production
3. Health check endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç
4. HTTPS –¥–æ—Å—Ç—É–ø–µ–Ω (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
5. Security headers —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
6. Rate limiting —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
7. –ü–∞—Ä–æ–ª–∏ –≤ –ë–î (–±–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- ‚úÖ ENCRYPTION_KEY —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ Security headers –¥–æ–±–∞–≤–ª–µ–Ω—ã
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç

### –í–∞–∂–Ω—ã–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è HTTPS
- ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—á–µ—Ä–µ–∑ cron)
- ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–ø—ã—Ç–æ–∫ –≤–∑–ª–æ–º–∞

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å WAF (Web Application Firewall)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å DDoS –∑–∞—â–∏—Ç—É
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:**
   ```bash
   # –ß–µ—Ä–µ–∑ Let's Encrypt
   certbot --nginx -d yourdomain.com
   ```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
   ```bash
   # –î–æ–±–∞–≤–∏—Ç—å –≤ crontab (–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ)
   0 0 * * 0 /opt/flamecrm/scripts/check-security.sh >> /opt/flamecrm/logs/security.log 2>&1
   ```

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏ –Ω–∞ –ø–æ–ø—ã—Ç–∫–∏ –≤–∑–ª–æ–º–∞
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (rate limiting)

## ‚úÖ –ò—Ç–æ–≥

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –±–∞–∑–æ–≤–æ–º —É—Ä–æ–≤–Ω–µ:**
- ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Rate limiting –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç DDoS
- ‚úÖ Security headers –∑–∞—â–∏—â–∞—é—Ç –æ—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö –∞—Ç–∞–∫
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—ä–µ–∫—Ü–∏–∏
- ‚úÖ Prisma –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç SQL injection

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:**
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫–∏ –≤–∑–ª–æ–º–∞

